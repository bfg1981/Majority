<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Majority Calculator â€“ Governing Body Demo</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <h1>Governing body viewer</h1>
  <p>This demo loads a governing-body JSON and shows each group as a selectable item.</p>

  <div id="governing-body-output"></div>

  <script src="governing-body-viewer.js"></script>
<script type="module">
  import { getConfigIndex } from "./config-discovery.js";

  const targetId = "governing-body-output";

  // Promise that resolves when DOM is ready
  const domReady = new Promise((resolve) => {
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", () => resolve(), {
        once: true,
      });
    } else {
      resolve();
    }
  });

  // Promise that resolves with the discovered configs
  const configsReady = getConfigIndex();

  Promise.all([domReady, configsReady])
    .then(([, entries]) => {
      if (!entries || entries.length === 0) {
        console.warn("[init] No config entries discovered.");
        return;
      }

      const first = entries[0]; // { file, label }

      if (typeof window.loadGoverningBody !== "function") {
        console.error(
          "[init] window.loadGoverningBody is not available. Did governing-body-viewer.js load?"
        );
        return;
      }

      console.log(first.file);
      window.loadGoverningBody(first.file, targetId);
    })
    .catch((err) => {
      console.error("[init] Failed to initialize governing body viewer:", err);
    });
</script>

</body>
</html>
